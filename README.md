# Инструкция по использованию проекта

## Описание
Этот проект предоставляет Go-сервер, который позволяет принимать изображения в формате JPEG через POST-запрос, ресэмплить их до заданного размера и сохранять обработанные изображения на диск. Также реализована валидация входных данных, кеширование обработанных изображений и замер времени обработки.

## Функции

- Принимает изображение в формате JPEG в base64 через POST-запрос.
- Ресэмплит изображение до заданных размеров (например, 200x200 пикселей).
- Сохраняет обработанное изображение в файл.
- Если изображение уже было обработано с такими параметрами, используется кешированное изображение.
- Валидация: максимальный размер base64 контента — 10 МБ, минимальный — 1024 байта. Разрешен только формат JPEG.
- Время обработки изображения выводится в миллисекундах.
- При ошибке возвращается код 400 и описание ошибки.

## Запуск сервера

1. Клонируйте репозиторий:
   ```bash
   git clone <URL>
   cd <project-folder>
   ```

2. Установите зависимости:
   ```bash
   go mod tidy
   ```

3. Запустите сервер с параметрами:
   ```bash
   go run cmd/main.go -path-orig <path-to-save-original-images> -path-res <path-to-save-processed-images> -width <width> -height <height>
   ```

   Параметры:
    - `-path-orig <path>` — директория для сохранения исходных изображений. По умолчанию: `/tmp/img_orig/`.
    - `-path-res <path>` — директория для сохранения обработанных изображений. По умолчанию: `/tmp/img_res/`.
    - `-width <int>` — ширина результирующего изображения (по умолчанию 200).
    - `-height <int>` — высота результирующего изображения (по умолчанию 200).

4. Сервер будет слушать на порту 8085.

## Пример запроса

Пример отправки POST-запроса с изображением в base64:

```bash
curl -X POST http://localhost:8085/ -d '{"image": "<base64-encoded-content>"}' -H "Content-Type: application/json"
```

## Пример ответа

- Успешный ответ (код 200):
  ```json
  {
    "time": 123,
    "cached": false
  }
  ```

- Ошибка (код 400):
  ```json
  {
    "error": "Invalid image format"
  }
  ```

## Автотесты

Для проверки работоспособности можно запустить тесты:

```bash
go test ./test -v
```

## Размещение на Docker

Проект можно запустить в Docker. Для этого используйте следующие команды:

1. Соберите Docker-образ:
   ```bash
   docker build -t image-resampler .
   ```

2. Запустите контейнер:
   ```bash
   docker run -p 8085:8085 image-resampler
   ```
